VOICI LE RÉSULTAT FINAL ET REECRIS DES MEILLEUR REPONSE FUSIONÉ EN UNE SEUL :

ANALYSE TECHNIQUE ET SOLUTION : MCP CONNECTÉS MAIS NON UTILISÉS DANS KIRO (OCT. 2025)
RÉSUMÉ CONCIS DU PROBLÈME

Constat : Les logs Kiro indiquent Successfully connected pour les serveurs MCP filesystem, chrome-devtools, et playwright, mais aucun agent (Claude, GPT-5, etc.) n'exécute d'appels tools/call réels. Les réponses sont théoriques (pseudo-code) ou des refus.

Cause probable (confirmée par logs) : Le log [filesystem] Client does not support MCP Roots... est le point clé. Il indique que le client Kiro n'implémente pas le protocole MCP Roots. Par conséquent, les serveurs MCP ne savent pas quelles fonctions exposer ou quels répertoires sont autorisés, sauf si ces répertoires sont explicitement fournis lors du démarrage du serveur.

Objectif : Diagnostiquer la connexion serveur-client via un test direct (hors-robot) et forcer l'exposition des outils au client Kiro et à l'agent IA.

ÉTAPE 1 : VÉRIFICATION DIRECTE DES SERVEURS MCP (POWERSHELL)
Avant de blâmer le robot, vérifiez si les serveurs MCP eux-mêmes répondent. Exécutez ce test dans un terminal Windows PowerShell (pas dans Kiro).

PowerShell

# Test direct du serveur MCP filesystem via npx
$testPayload = '{"jsonrpc":"2.0","id":1,"method":"tools/call","params":{"name":"list_directory","arguments":{"path":"G:\\\\memobrik"}}}'
$testPayload | & "npx" "@modelcontextprotocol/server-filesystem" "G:\memobrik"
RÉSULTAT ATTENDU (SI LE SERVEUR FONCTIONNE) : Vous devez voir une réponse JSON-RPC brute, prouvant que le serveur fonctionne :

JSON

{
  "jsonrpc": "2.0",
  "id": 1,
  "result": {
    "content": [
      {"type": "directory", "name": "src"},
      {"type": "file", "name": "package.json"}
    ]
  }
}
Si ce test ÉCHOUE : Le problème vient de votre installation npx ou des permissions du serveur MCP.

Si ce test RÉUSSIT : Le problème est l'intégration entre Kiro et les serveurs. Passez à l'étape 2.

ÉTAPE 2 : CORRECTION DE LA CONFIGURATION (SERVEUR ET CLIENT KIRO)
Le log Client does not support MCP Roots nous oblige à configurer Kiro et les serveurs manuellement.

A. Configuration Côté Client (Kiro) Le fichier de configuration de Kiro doit lister les serveurs et leur dire comment démarrer.

Fichier : .kiro/settings/mcp.json (dans votre dossier de projet G:\memobrik)

JSON

{
  "servers": [
    {
      "name": "filesystem",
      "type": "server-filesystem",
      "command": "npx",
      "args": [
        "@modelcontextprotocol/server-filesystem",
        "G:\\\\memobrik"
      ]
    },
    {
      "name": "chromeDevtools",
      "type": "server-chrome-devtools",
      "command": "npx",
      "args": [
        "@modelcontextprotocol/server-chrome-devtools",
        "--port",
        "9222"
      ]
    },
    {
      "name": "playwright",
      "type": "server-playwright",
      "command": "npx",
      "args": [
        "@modelcontextprotocol/server-playwright"
      ]
    }
  ],
  "client": {
    "allowedRoots": ["G:\\\\memobrik"]
  }
}
(Remarque : Les doubles backslashes \\\\ sont nécessaires dans le JSON pour échapper le chemin Windows).

B. Configuration Côté Serveur (Si Kiro ne lance pas les serveurs) Si vous lancez vos serveurs MCP manuellement (hors Kiro), vous DEVEZ passer les répertoires autorisés via les arguments et les variables d'environnement à cause du bug "MCP Roots".

Exemple pour mcp-config.json ou un script de démarrage :

JSON

{
  "mcpServers": {
    "filesystem": {
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-filesystem",
        "G:\\memobrik"
      ],
      "env": {
        "MCP_ALLOWED_DIRECTORIES": "G:\\memobrik"
      }
    }
  }
}
ACTION : Redémarrez Kiro après avoir créé/modifié le fichier .kiro/settings/mcp.json.