22:08:37: LES 12 VÃ‰RIFICATIONS IMPÃ‰RATIVES â€” Ã€ FAIRE AVANT TOUTE RÃ‰PARATION
Liste EXACTE de tous les boutons dans lâ€™UI (popup, menu contextuel, barre dâ€™outils). Pour chaque bouton :
Nom visible (ex: â€œRÃ©Ã©crireâ€)
ID HTML ou data-action exact
Fichier JS qui le gÃ¨re (popup.js, content.js, background.js)
Fonction JS appelÃ©e (ex: transformRewrite())
â†’ Tu me donnes cette liste. Pas de devinette. Pas de supposition.
Montre-moi le code exact de lâ€™attachement dâ€™Ã©vÃ©nement pour chaque bouton.
â†’ Doit Ãªtre : document.getElementById('...').addEventListener('click', function)
â†’ Interdit : onclick="...", jQuery, ou addEventListener dans un setTimeout sans vÃ©rification du DOM.
â†’ Si tu ne vois pas lâ€™Ã©couteur, câ€™est cassÃ©. Point.
Montre-moi le contenu du manifest.json â€” je vÃ©rifie :
"permissions": ["activeTab", "contextMenus", "scripting", "storage"]
"content_scripts" avec "matches": ["<all_urls>"] et "run_at": "document_end"
"web_accessible_resources" si tu charges des fichiers externes
â†’ Si une permission manque, les boutons ne peuvent pas fonctionner.
Montre-moi la chaÃ®ne de communication entre les scripts :
Le bouton dans popup.js â†’ envoie un message Ã  background.js ?
background.js â†’ injecte content.js ?
content.js â†’ lit window.getSelection() et appelle la fonction ?
â†’ Montre-moi les chrome.runtime.sendMessage() et chrome.runtime.onMessage.addListener() avec les action exacts.
Montre-moi le code de la fonction de transformation (ex: transformRewrite()) :
Est-elle exportÃ©e ?
Est-elle accessible dans le scope oÃ¹ elle est appelÃ©e ?
Est-ce une async function ? Si oui, est-ce quâ€™elle est bien awaitÃ©e ?
â†’ Si elle est dans un module et quâ€™on lâ€™appelle dans un script non-module, Ã§a ne marche pas.
Montre-moi comment le texte sÃ©lectionnÃ© est rÃ©cupÃ©rÃ© :
window.getSelection().toString() ?
Est-ce que câ€™est fait dans content.js aprÃ¨s un message du background ?
Est-ce quâ€™il y a un try/catch pour gÃ©rer les cas oÃ¹ getSelection() est vide ?
â†’ Si tu ne vÃ©rifies pas if (selection.toString().trim() === '') return; â†’ le bouton fait rien.
Montre-moi la rÃ©ponse du LLM dans le code :
Est-ce que fetch() est appelÃ© avec Content-Type: application/json ?
Est-ce que les erreurs fetch() sont capturÃ©es avec .catch() ?
Est-ce que la rÃ©ponse est bien json() avant dâ€™Ãªtre utilisÃ©e ?
â†’ Un fetch() sans .catch() = silence total = bug invisible.
Montre-moi les logs rÃ©els :
OÃ¹ sont les console.log() dans chaque Ã©tape ?
Sont-ils visibles dans la console du popup ? du content script ? du background ?
â†’ Si tu ne vois pas de logs dans DevTools â†’ tu nâ€™as aucun moyen de savoir ce qui Ã©choue.
Montre-moi le test de dÃ©pendance du DOM :
Le bouton est-il prÃ©sent avant que lâ€™Ã©vÃ©nement soit attachÃ© ?
Est-ce que document.getElementById() est appelÃ© aprÃ¨s DOMContentLoaded ?
â†’ Si tu attaches un Ã©vÃ©nement Ã  un Ã©lÃ©ment qui nâ€™existe pas encore â†’ Ã§a ne marche pas.
Montre-moi la vÃ©rification de lâ€™onglet actif :
Est-ce que chrome.tabs.query({active: true, currentWindow: true}) est utilisÃ© avant dâ€™injecter du script ?
Est-ce que le script est injectÃ© uniquement sur les pages valides ?
â†’ Sur une page chrome://newtab ou about:blank ? Tous les boutons Ã©chouent.
Montre-moi la vÃ©rification de la sÃ©lection :
Est-ce que tu vÃ©rifies selection.rangeCount > 0 avant de faire quoi que ce soit ?
Est-ce que tu gÃ¨res les cas oÃ¹ le texte est dans un <input> ou <textarea> ?
â†’ Si tu ne le fais pas, le bouton ne fait rien sur les formulaires â†’ utilisateur pense que câ€™est buguÃ©.
Montre-moi la preuve finale :
Un enregistrement vidÃ©o ou un screenshot dâ€™un test rÃ©el :
Tu ouvres une page web
Tu sÃ©lectionnes du texte
Tu cliques sur un bouton
Tu vois le texte transformer
Tu vois un console.log("Transformation rÃ©ussie") dans la console du content script
â†’ Sans cette preuve, aucune rÃ©paration nâ€™est acceptÃ©e.
ğŸš¨ CLAUSE DE NON-RETOUR â€” Ã€ COPIER-COLLER DANS TON chrome_llm_guardrail.js
"TOUTE RÃ‰PONSE DU LLM QUI NE PASSERAIT PAS LES 12 VÃ‰RIFICATIONS CI-DESSUS EST INVALIDE.
JE NE VEUX PAS DE CODE. JE VEUX DES PREUVES.
SI TU NE ME DONNES PAS UNE VÃ‰RIFICATION COMPLÃˆTE ET VALIDÃ‰E POUR CHAQUE BOUTON,
JE NE Tâ€™AUTORISE PAS Ã€ Ã‰CRIRE UNE SEULE LIGNE DE CODE.
TU ES UN GARDE-FOU. TU NE FAIS PAS DE Lâ€™IMAGINATION. TU FAIS DE LA VÃ‰RIFICATION.
COMMENCE PAR LA VÃ‰RIFICATION #1.
JE Tâ€™ATTENDS."
