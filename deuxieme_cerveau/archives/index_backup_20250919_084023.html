<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Deuxi√®me Cerveau Dynamique</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 0;
            margin: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        /* Dynamic Container System */
        .dynamic-container {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: auto;
            gap: 15px;
            padding: 15px;
            min-height: 100vh;
            transition: all 0.3s ease;
        }

        .dynamic-section {
            background: white;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: all 0.3s ease;
            position: relative;
            min-height: 200px;
            display: flex;
            flex-direction: column;
        }

        .dynamic-section:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(0,0,0,0.15);
        }

        .section-header {
            background: linear-gradient(135deg, #6A4C93 0%, #8B5FBF 100%);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move;
            user-select: none;
        }

        .section-header h1, .section-header h2 {
            margin: 0;
            font-size: 1.2rem;
            font-weight: 600;
        }

        /* Fusion Buttons */
        .fusion-buttons {
            display: flex;
            gap: 10px;
            margin-right: 10px;
        }

        .fusion-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .fusion-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
            background: linear-gradient(135deg, #218838 0%, #1ea085 100%);
        }

        .fusion-btn:active {
            transform: translateY(0);
        }

        .fusion-btn.secondary {
            background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
        }

        .fusion-btn.secondary:hover {
            background: linear-gradient(135deg, #5a6268 0%, #495057 100%);
            box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
        }

        /* Enhanced styling for existing elements */
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
            contain: layout style;
            position: relative;
        }

        .folder-buttons-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 10px;
        }

        .all-notes-btn {
            background: #6A4C93;
            color: white;
            width: 100%;
            height: 60px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .all-notes-btn:hover {
            background: #5a3d7a;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .section-help {
            font-size: 12px;
            color: #666;
            margin-bottom: 15px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        /* === EMOJI SIZES (Critical for visual consistency) === */
        .section-header h1 .brain-emoji {
            font-size: 1.2em; /* üß† emoji size */
        }

        .section-header h2 .notes-emoji {
            font-size: 1.2em; /* üìö emoji size */
        }

        .section-header h2 .folders-emoji {
            font-size: 1.2em; /* üìÇ emoji size */
        }

        /* Modal emoji sizes */
        .fusion-modal .fusion-option span {
            font-size: 2rem; /* üìö emoji in modal */
        }

        .fusion-modal .category-emoji {
            font-size: 1.5rem; /* Category emojis in modal */
        }

        .fusion-modal .arrow-emoji {
            font-size: 1.2rem; /* ‚Üí arrow emoji */
        }

        textarea {
            width: 100%;
            height: 150px;
            font-size: 18px;
            padding: 15px;
            margin-bottom: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
        }

        textarea:focus {
            outline: none;
            border-color: #45B7D1;
        }

        .filter-buttons {
            margin-bottom: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .filter-btn {
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 20px;
            background: white;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        .filter-btn.active {
            color: white;
            border-color: transparent;
        }

        .filter-btn:hover {
            transform: scale(1.05);
        }

        .backup-btn {
            background: linear-gradient(45deg, #28a745, #20c997) !important;
            color: white !important;
            font-size: 16px !important;
            padding: 12px 20px !important;
            margin: 10px 0 !important;
            width: auto !important;
            height: auto !important;
            border-radius: 8px !important;
            border: none !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
        }

        .backup-btn:hover {
            background: linear-gradient(45deg, #218838, #1ea085) !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2) !important;
        }

        /* Scenario Slider */
        .scenario-slider-trigger {
            background: linear-gradient(135deg, #FF6B6B 0%, #FFA500 100%);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 20px auto;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
            position: relative;
            z-index: 10;
        }

        .scenario-slider-trigger:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
            background: linear-gradient(135deg, #FF5252 0%, #FF8C00 100%);
        }

        .scenario-vertical-slider {
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15);
            padding: 0;
            margin-top: 10px;
            min-width: 220px;
            opacity: 0;
            visibility: hidden;
            transform: translateX(-50%) translateY(-20px);
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1000;
            border: 1px solid #e9ecef;
        }

        .scenario-vertical-slider.active {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(0);
        }

        .scenario-slider-button {
            display: block;
            width: 100%;
            padding: 15px 20px;
            background: none;
            border: none;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s ease;
            border-bottom: 1px solid #f8f9fa;
            font-size: 15px;
            font-weight: 500;
            color: #495057;
        }

        .scenario-slider-button:hover {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.1) 0%, rgba(255, 165, 0, 0.1) 100%);
            color: #FF6B6B;
        }

        /* Section Controls */
        .section-controls {
            display: flex;
            gap: 8px;
        }

        .control-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .control-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.1);
        }

        .section-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            transition: all 0.3s ease;
        }

        .new-category {
            display: flex;
            margin-top: 15px;
            gap: 10px;
        }

        .new-category input {
            flex: 1;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
        }

        .new-category input:focus {
            border-color: #45B7D1;
        }

        .new-category button {
            width: auto;
            height: auto;
            padding: 10px 20px;
            background: #6A4C93;
        }
    </style>
</head>
<body>
    <div class="dynamic-container">
        <!-- Main Content Section -->
        <div class="dynamic-section main-section" id="main-section" data-section="main">
            <div class="section-header">
            <h1><span class="brain-emoji">üß†</span> Deuxi√®me Cerveau - Mode Turbo</h1>
                <div class="fusion-buttons">
                    <button class="fusion-btn"
                            onclick="handleFusionButtonClick(this, 'global')"
                            title="Fusionner toutes les notes en un seul fichier"
                            aria-label="Fusionner toutes les notes en un seul fichier"
                            role="button"
                            tabindex="0">
                        üîó Fusion Globale
                    </button>
                    <button class="fusion-btn secondary"
                            onclick="handleFusionButtonClick(this, 'category')"
                            title="Fusionner par cat√©gorie"
                            aria-label="Fusionner par cat√©gorie - Afficher la liste des cat√©gories"
                            role="button"
                            tabindex="0">
                        üìÅ Fusion par Cat√©gorie
                    </button>
                </div>
                <div class="section-controls">
                    <button class="control-btn collapse-btn" onclick="toggleSection('main-section')" title="R√©duire/Agrandir">
                        <span class="collapse-icon">‚ñº</span>
                    </button>
                    <button class="control-btn resize-btn" onmousedown="startResize(event, 'main-section')" title="Redimensionner">
                        <span>‚§°</span>
                    </button>
                </div>
            </div>
            <div class="section-content">
                <button class="backup-btn" onclick="createBackup()" id="backup-button">
                    üíæ Cr√©er un Backup Complet
                </button>
                <textarea id="note-input"
                          placeholder="√âcris ton id√©e et clique sur une cat√©gorie = sauvegarde instantan√©e ‚ö°"
                          autofocus></textarea>

                <div id="categories-container" class="categories-grid"></div>

                <div class="new-category">
                    <div style="flex: 1; position: relative;">
                        <input type="text" id="new-category-name"
                               placeholder="Nouvelle cat√©gorie (19 caract√®res max)"
                               maxlength="19"
                               oninput="limitInputLength(this, 19)"
                               onpaste="handlePaste(this, 19)"
                               onkeydown="preventOverflow(this, 19)"
                               onkeyup="limitInputLength(this, 19)"
                               onkeypress="if(event.key==='Enter') addNewCategory()">
                        <div id="char-counter" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); font-size: 12px; color: #666; pointer-events: none;">0/19</div>
                    </div>
                    <button onclick="addNewCategory()">+ Cr√©er</button>
                </div>
            </div>
        </div>

        <!-- Bouton Slider Test -->
        <div style="text-align: center; position: relative;">
            <button class="scenario-slider-trigger" id="scenario-slider-btn">
                üß™ Test
                <span class="arrow">‚ñº</span>
            </button>

            <!-- Slider vertical cach√© par d√©faut -->
            <div class="scenario-vertical-slider" id="scenario-vertical-slider">
                <button class="scenario-slider-button" onclick="changeCategoryColor()">
                    üé® Changer couleur
                </button>
                <button class="scenario-slider-button" onclick="renameCategory()">
                    ‚úèÔ∏è Renommer dossier
                </button>
                <button class="scenario-slider-button" onclick="deleteCategory()">
                    üóëÔ∏è Supprimer le dossier
                </button>
            </div>
        </div>

        <!-- Notes Section -->
        <div class="dynamic-section notes-section" id="notes-section" data-section="notes">
            <div class="section-header">
                <h2><span class="notes-emoji">üìö</span> Notes</h2>
                <div class="section-controls">
                    <button class="control-btn collapse-btn" onclick="toggleSection('notes-section')" title="R√©duire/Agrandir">
                        <span class="collapse-icon">‚ñº</span>
                    </button>
                    <button class="control-btn resize-btn" onmousedown="startResize(event, 'notes-section')" title="Redimensionner">
                        <span>‚§°</span>
                    </button>
                </div>
            </div>
            <div class="section-content">
                <div id="toutes-notes-button">
                    <button onclick="window.open('/all_notes', '_blank')" class="all-notes-btn">
                        üìö Toutes les Notes
                    </button>
                </div>
            </div>
        </div>

        <!-- Folders Section -->
        <div class="dynamic-section folders-section" id="folders-section" data-section="folders">
            <div class="section-header">
                <h2><span class="folders-emoji">üìÇ</span> Dossiers par cat√©gorie</h2>
                <div class="section-controls">
                    <button class="control-btn collapse-btn" onclick="toggleSection('folders-section')" title="R√©duire/Agrandir">
                        <span class="collapse-icon">‚ñº</span>
                    </button>
                    <button class="control-btn resize-btn" onmousedown="startResize(event, 'folders-section')" title="Redimensionner">
                        <span>‚§°</span>
                    </button>
                </div>
            </div>
            <div class="section-content">
                <div class="section-help">Clique sur un bouton pour ouvrir l'emplacement (cat√©gorie) et acc√©der au dernier fichier.</div>
                <div id="filter-buttons" class="filter-buttons"></div>
                <div id="folder-buttons" class="folder-buttons-grid"></div>
            </div>
        </div>
    </div>

    <!-- Fusion Modal -->
    <div id="fusionModal" class="fusion-modal">
        <div class="fusion-modal-content">
            <div class="fusion-modal-header">
                <h2 id="fusionModalTitle">üîó Fusion des Notes</h2>
                <button class="fusion-modal-close" onclick="closeFusionModal()">&times;</button>
            </div>
            <div class="fusion-modal-body">
                <div id="fusionModalContent">
                    <!-- Content will be dynamically generated -->
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
